/*
 Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
 For licensing, see LICENSE.html or http://ckeditor.com/license
*/
(function(){function s(a){var e="left"==a?"pageXOffset":"pageYOffset";return e in g.$?g.$[e]:CKEDITOR.document.$.documentElement["left"==a?"scrollLeft":"scrollTop"]}function o(a){var e,f=a.config,o=f.floatSpaceDockedOffsetX||0,n=f.floatSpaceDockedOffsetY||0,t=f.floatSpacePinnedOffsetX||0,p=f.floatSpacePinnedOffsetY||0,h=function(d){function f(a,b,d){c.setStyle(b,r(d));c.setStyle("position",a)}function j(a){var d=m.getDocumentPosition();switch(a){case "top":f("absolute","top",d.y-k-n);break;case "pin":f("fixed",
"top",p);break;case "bottom":f("absolute","top",d.y+(b.height||b.bottom-b.top)+n)}e=a}"focus"==d.name&&c.show();var l="scroll"!=d.name;l&&(c.removeStyle("left"),c.removeStyle("right"));var m=a.editable(),i=c.getClientRect(),b=m.getClientRect(),k=i.height,q=s("left");e?("top"==e&&i.top<p?j("pin"):"pin"==e?b.top>n+k?j("top"):b.bottom-i.bottom<k&&j("bottom"):"bottom"==e&&(b.top>n+k?j("top"):b.bottom>2*k+p&&j("pin")),l&&(d=g.getViewPaneSize(),l=d.width/2,i=0<b.left&&b.right<d.width&&b.width>i.width?"rtl"==
a.lang.dir?"right":"left":l-b.left>b.right-l?"left":"right",c.setStyle(i,r(("pin"==e?t:o)+("left"==i?0<b.left?b.left:0:b.right<d.width?d.width-b.right:0)+q)))):(e="pin",j("pin"),h(d))},f=CKEDITOR.document.getBody(),q={id:a.id,name:a.name,langDir:a.lang.dir,langCode:a.langCode},m=a.fire("uiSpace",{space:"top",html:""}).html;if(m){var c=f.append(CKEDITOR.dom.element.createFromHtml(u.output(CKEDITOR.tools.extend({topId:a.ui.spaceId("top"),content:m,style:"display:none;z-index:"+(a.config.baseFloatZIndex-
1)},q))));c.unselectable();c.on("mousedown",function(a){a=a.data;a.getTarget().hasAscendant("a",1)||a.preventDefault()});a.on("focus",function(a){h(a);g.on("scroll",h);g.on("resize",h)});a.on("blur",function(){c.hide();g.removeListener("scroll",h);g.removeListener("resize",h)});a.on("destroy",function(){g.removeListener("scroll",h);g.removeListener("resize",h);c.clearCustomData();c.remove()});a.focusManager.hasFocus&&c.show();a.focusManager.add(c,1)}}var u=CKEDITOR.addTemplate("floatcontainer",'<div id="cke_{name}" class="cke {id} cke_reset_all cke_chrome cke_editor_{name} cke_float cke_{langDir} '+
CKEDITOR.env.cssClass+'" dir="{langDir}" title="'+(CKEDITOR.env.gecko?" ":"")+'" lang="{langCode}" role="presentation" style="{style}"><div class="cke_inner"><div id="{topId}" class="cke_top" role="presentation">{content}</div></div></div>');CKEDITOR.plugins.add("floatingspace",{init:function(a){a.on("contentDom",function(){o(a)})}});var g=CKEDITOR.document.getWindow(),r=CKEDITOR.tools.cssLength})();